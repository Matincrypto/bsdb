# bsdb
حتما\! با کمال میل یک فایل `README.md` کامل و حرفه‌ای برای اسکریپت شما به زبان فارسی می‌نویسم. این فایل به خوبی ساختار استراتژی، نحوه عملکرد و تنظیمات آن را توضیح می‌دهد تا برای هر کسی که به صفحه گیت‌هاب شما مراجعه می‌کند، قابل فهم باشد.

می‌توانید متن زیر را کپی کرده و در فایلی به نام `README.md` در پروژه گیت‌هاب خود قرار دهید.

-----

# استراتژی فیلتر محدوده (Range Filter) با سیگنال‌های خرید و فروش برای تریدینگ ویو

این یک استراتژی برای پلتفرم [TradingView](https://www.tradingview.com/) است که بر اساس اندیکاتور محبوب "Range Filter" نوشته شده است. هدف این استراتژی، شناسایی جهت روند بازار و ارائه سیگنال‌های واضح برای ورود به معاملات خرید (Long) و فروش (Short) است.

این نسخه از کد، ورژن ساده‌تر و قدیمی‌تر Range Filter است که تنظیمات کمتری دارد و برای شروع کار مناسب‌تر است.

**اعتبار:** این اسکریپت بر اساس اندیکاتور [Range Filter - DonovanWall](https://www.tradingview.com/script/lut7sBgG-Range-Filter-DW/) توسعه داده شده است.

-----

## 🚀 ویژگی‌ها

  * **سیگنال‌های واضح خرید و فروش:** نمایش سیگنال‌های `BUY` و `SELL` به صورت خودکار روی چارت.
  * **فیلتر روند اصلی:** استفاده از اندیکاتور Range Filter برای تشخیص روند صعودی یا نزولی بازار.
  * **فیلتر روند ثانویه:** استفاده از یک میانگین متحرک نمایی (EMA) با دوره طولانی (پیش‌فرض ۲۰۰) برای تایید بیشتر روند.
  * **مدیریت ریسک داخلی:** تعیین حد سود (Take Profit) و حد ضرر (Stop Loss) بر اساس درصد از قیمت ورود.
  * **قابلیت بک‌تست (Backtest):** امکان تست استراتژی در بازه‌های زمانی دلخواه برای ارزیابی عملکرد.
  * **شخصی‌سازی بالا:** تمام پارامترهای اصلی مانند دوره فیلتر، ضریب حساسیت و تنظیمات مدیریت ریسک قابل تغییر هستند.
  * **نمایش بصری جذاب:** رنگ‌آمیزی کندل‌ها و نمایش باندهای بالا و پایین فیلتر برای درک بهتر وضعیت بازار.

-----

## ⚙️ نحوه عملکرد استراتژی

منطق اصلی این استراتژی بر پایه ترکیب دو فیلتر برای تصمیم‌گیری استوار است:

1.  **Range Filter:** این اندیکاتور قیمت را هموار کرده و یک خط مرکزی (فیلتر) تولید می‌کند.

      * اگر قیمت **بالای** خط فیلتر باشد و جهت فیلتر **صعودی** باشد، بازار در حالت صعودی در نظر گرفته می‌شود.
      * اگر قیمت **پایین** خط فیلتر باشد و جهت فیلتر **نزولی** باشد، بازار در حالت نزولی در نظر گرفته می‌شود.

2.  **فیلتر EMA (پیش‌فرض ۲۰۰):** این استراتژی از یک EMA بلندمدت به عنوان فیلتر دوم برای تایید روند کلی بازار استفاده می‌کند.

### منطق ورود به معامله

  * **سیگنال خرید (Long):** یک سیگنال خرید زمانی صادر می‌شود که **هر دو شرط** زیر برقرار باشند:

    1.  اندیکاتور Range Filter یک تغییر روند از نزولی به صعودی را نشان دهد (`longCondition`).
    2.  قیمت فعلی (Close) **بالاتر** از خط EMA 200 باشد.

  * **سیگنال فروش (Short):** یک سیگنال فروش زمانی صادر می‌شود که **هر دو شرط** زیر برقرار باشند:

    1.  اندیکاتور Range Filter یک تغییر روند از صعودی به نزولی را نشان دهد (`shortCondition`).
    2.  قیمت فعلی (Close) **پایین‌تر** از خط EMA 200 باشد.

### منطق خروج از معامله

  * هر معامله باز (چه خرید و چه فروش) با رسیدن قیمت به یکی از دو سطح زیر به طور خودکار بسته می‌شود:
      * **حد سود (Take Profit):** بر اساس درصدی از قیمت ورود (`longTakePerc` یا `shortTakePerc`).
      * **حد ضرر (Stop Loss):** بر اساس درصدی از قیمت ورود (`longLossPerc` یا `shortLossPerc`).

-----

## 🛠️ نحوه استفاده و نصب

1.  وارد وب‌سایت [TradingView](https://www.tradingview.com/) شوید.
2.  در پایین صفحه، تب **"Pine Editor"** را باز کنید.
3.  تمام محتویات فایل کد (`.pine`) را کپی کنید.
4.  کد کپی‌شده را در Pine Editor جای‌گذاری کنید و محتویات قبلی را پاک کنید.
5.  روی دکمه **"Add to Chart"** کلیک کنید.
6.  استراتژی به چارت شما اضافه خواهد شد. برای تغییر تنظیمات، روی آیکون چرخ‌دنده (⚙️) کنار نام استراتژی کلیک کنید.

-----

## 📊 تنظیمات ورودی (Inputs)

شما می‌توانید پارامترهای زیر را برای بهینه‌سازی استراتژی بر روی نمادها و تایم‌فریم‌های مختلف تغییر دهید:

| نام پارامتر             | توضیحات                                                                   | مقدار پیش‌فرض |
| ----------------------- | -------------------------------------------------------------------------- | ------------- |
| `Backtest Start`        | تاریخ شروع بک‌تست استراتژی.                                               | 1 ژانویه 2020 |
| `Backtest End`          | تاریخ پایان بک‌تست استراتژی.                                              | 1 ژانویه 2024 |
| `Long Stop Loss (%)`    | درصد حد ضرر برای معاملات خرید.                                            | 1%            |
| `Short Stop Loss (%)`   | درصد حد ضرر برای معاملات فروش.                                            | 1%            |
| `Long Take (%)`         | درصد حد سود برای معاملات خرید.                                             | 1%            |
| `Short Take (%)`        | درصد حد سود برای معاملات فروش.                                             | 1%            |
| `EMA Length`            | دوره زمانی میانگین متحرک نمایی (EMA) برای فیلتر روند بلندمدت.              | 200           |
| `Swing Source`          | منبع قیمت برای محاسبات فیلتر (مانند `close`, `open`, `hl2`).               | `close`       |
| `Swing Period`          | دوره زمانی (تعداد کندل‌ها) برای محاسبه محدوده نوسان.                       | 20            |
| `Swing Multiplier`      | ضریب حساسیت فیلتر. اعداد بزرگتر فیلتر را نرم‌تر و اعداد کوچکتر آن را حساس‌تر می‌کنند. | 3.5           |
| `Bar Colors On/Off`     | فعال یا غیرفعال کردن رنگ‌آمیزی کندل‌ها بر اساس روند.                       | `false`       |

-----

## 📜 مجوز (License)

این پروژه تحت مجوز **Mozilla Public License 2.0** منتشر شده است. برای اطلاعات بیشتر فایل `LICENSE` را مطالعه کنید.

-----

## ⚠️ سلب مسئولیت

این اسکریپت صرفاً برای اهداف آموزشی و تحقیقاتی ارائه شده است و به هیچ عنوان یک توصیه مالی یا سیگنال قطعی برای سرمایه‌گذاری نیست. بازارهای مالی با ریسک همراه هستند و عملکرد گذشته یک استراتژی، تضمینی برای سودآوری آن در آینده نیست. همیشه قبل از استفاده از هر استراتژی با پول واقعی، آن را به طور کامل بک‌تست کرده و مدیریت ریسک مناسب را رعایت کنید.
